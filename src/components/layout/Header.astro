---
import ThemeToggle from "../ThemeToggle.astro";
import { MENU_LINKS } from "@/data/constants";

const url = new URL(Astro.request.url);
---

<script>
  import { toggleClass } from "@/utils";

  document.addEventListener("DOMContentLoaded", () => {
    const header = document.getElementById("main-header") as HTMLElement;
    const toggleMenuButton = document.getElementById("toggle-navigation-menu") as HTMLButtonElement;
    let menuOpen = false;

    toggleMenuButton.addEventListener("click", () => {
      toggleClass(header, "menu-open");
      menuOpen = !menuOpen;
      toggleMenuButton.setAttribute("aria-expanded", menuOpen.toString());
    });
  });
</script>

<!-- <header id="main-header" class="group relative mb-8 flex items-center sm:ps-[4.5rem]"> -->
<header id="main-header" class="group relative mb-6 flex items-center">
  <div class="flex sm:flex-col">
    <a
      href="/"
      class="flex items-center gap-4 grayscale hover:filter-none"
      aria-current={url.pathname === "/" ? "page" : false}
    >
      <svg
        class="me-3 h-10 w-10 sm:h-16 sm:w-12"
        version="1.1"
        id="Layer_1"
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        viewBox="0 0 523 373"
        enable-background="new 0 0 523 373"
        xml:space="preserve"
      >
        <path
          fill="none"
          opacity="1.000000"
          stroke="none"
          d="
 M364.000000,374.000000
   C242.700363,374.000000 121.900719,374.000000 1.050538,374.000000
   C1.050538,249.735046 1.050538,125.470062 1.050538,1.102540
   C175.216309,1.102540 349.432709,1.102540 523.824585,1.102540
   C523.824585,125.333130 523.824585,249.666550 523.824585,374.000000
   C470.803375,374.000000 417.651703,374.000000 364.000000,374.000000
 M107.262848,328.000458
   C111.486900,328.849243 113.671997,327.009949 115.523895,323.122040
   C122.866783,307.706177 130.575928,292.464050 138.207794,277.186737
   C145.909012,261.770599 153.679504,246.389069 161.711182,230.412460
   C162.812271,232.446899 163.705536,233.993469 164.503784,235.587585
   C179.237778,265.011536 193.997726,294.422607 208.625504,323.899292
   C210.028366,326.726196 211.407715,328.117920 214.889481,328.098206
   C244.881653,327.928131 274.875336,327.956024 304.868073,328.067719
   C307.929474,328.079102 309.615112,327.173798 310.987549,324.384552
   C320.894379,304.250183 330.958496,284.193207 340.978638,264.114594
   C346.469299,253.112289 351.971436,242.115662 357.765411,230.522156
   C358.758850,232.286057 359.362976,233.255554 359.869781,234.273499
   C374.764557,264.189240 389.678741,294.095367 404.487701,324.053558
   C405.851105,326.811676 407.209290,328.135895 410.669647,328.113251
   C440.661499,327.917358 470.655151,328.004578 500.648285,327.986969
   C502.035339,327.986145 503.422241,327.790070 505.393768,327.640625
   C456.018433,229.093018 406.933838,131.125641 357.610626,32.682045
   C324.918945,98.270561 292.530640,163.250366 259.740753,229.035904
   C226.826538,162.977982 194.447159,97.993500 161.781982,32.435440
   C112.320389,131.363449 63.281456,229.446091 14.006666,328.000458
   C45.342571,328.000458 75.831017,328.000458 107.262848,328.000458
 z"
        ></path>
        <path
          fill="#646ECB"
          opacity="1.000000"
          stroke="none"
          d="
 M106.791153,328.000458
   C75.831017,328.000458 45.342571,328.000458 14.006666,328.000458
   C63.281456,229.446091 112.320389,131.363449 161.781982,32.435440
   C194.447159,97.993500 226.826538,162.977982 259.740753,229.035904
   C292.530640,163.250366 324.918945,98.270561 357.610626,32.682045
   C406.933838,131.125641 456.018433,229.093018 505.393768,327.640625
   C503.422241,327.790070 502.035339,327.986145 500.648285,327.986969
   C470.655151,328.004578 440.661499,327.917358 410.669647,328.113251
   C407.209290,328.135895 405.851105,326.811676 404.487701,324.053558
   C389.678741,294.095367 374.764557,264.189240 359.869781,234.273499
   C359.362976,233.255554 358.758850,232.286057 357.765411,230.522156
   C351.971436,242.115662 346.469299,253.112289 340.978638,264.114594
   C330.958496,284.193207 320.894379,304.250183 310.987549,324.384552
   C309.615112,327.173798 307.929474,328.079102 304.868073,328.067719
   C274.875336,327.956024 244.881653,327.928131 214.889481,328.098206
   C211.407715,328.117920 210.028366,326.726196 208.625504,323.899292
   C193.997726,294.422607 179.237778,265.011536 164.503784,235.587585
   C163.705536,233.993469 162.812271,232.446899 161.711182,230.412460
   C153.679504,246.389069 145.909012,261.770599 138.207794,277.186737
   C130.575928,292.464050 122.866783,307.706177 115.523895,323.122040
   C113.671997,327.009949 111.486900,328.849243 106.791153,328.000458
 z"
        ></path>
      </svg>
      <span class="text-xl font-bold sm:text-2xl">Micha≈Ç Michalczuk</span>
    </a>
    <nav
      id="navigation-menu"
      class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-[--theme-menu-bg] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-dashed sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
      aria-label="Main menu"
    >
      {
        MENU_LINKS.map((link) => (
          <a
            href={link.path}
            class="px-4 py-4 sm:py-0 sm:hover:underline"
            aria-current={url.pathname === link.path ? "page" : false}
            rel="prefetch"
          >
            {link.title}
          </a>
        ))
      }
    </nav>
  </div>
  <ThemeToggle />
  <button
    id="toggle-navigation-menu"
    class="group relative ms-8 h-7 w-7 sm:invisible sm:hidden"
    type="button"
    aria-label="Open main menu"
    aria-expanded="false"
    aria-haspopup="menu"
  >
    <svg
      id="line-svg"
      class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
      aria-hidden="true"
      focusable="false"
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke-width="1.5"
      stroke="currentColor"
    >
      <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 9h16.5m-16.5 6.75h16.5"></path>
    </svg>
    <svg
      id="cross-svg"
      class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
      class="text-accent"
      aria-hidden="true"
      focusable="false"
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke-width="1.5"
      stroke="currentColor"
    >
      <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
    </svg>
  </button>
</header>
